# Bellevue Eastgate dataset cross-validation results

## Clustering metadat

- Method: OPTICS, min-samples = 50, max-eps-distance = 0.2, xi = 0.15, p = 2
- Fefature vector used: 4D

## Cross validation with version 7 feature vectors used for classification 

`python3 -m sklearnex classification.py --n_jobs 18 cross-validation -db research_data/Bellevue_150th_SE38th/Bellevue_150th_SE38th_train_v2_10-18-20_11-08-14_clustered_4D_threshold-07.joblib --output research_data/Bellevue_150th_SE38th/tables/Bellevue_SE_v7_clustered_4D_threshold-07.xlsx --classification_features_version v7 --stride 15`  
                                                                                                                                                                                     
Training dataset size: 45388  

Validation dataset size: 14583  

Number of clusters: 10  
*Time: 800 s*  
                                                                               
#### Classifier parameters                                                                                                                                                                                                                                                                                                    
                                                                               
{'KNN': {'n_neighbors': 15}, 'SVM': {'kernel': 'rbf', 'probability': True, 'max_iter': 16000}}                                                                                                                                                                                                                                
                                                                               
#### Cross-val Basic accuracy                                                                                                                                                                                                                                                                                                 
                                                                               
|    | Split              |        KNN |        SVM |
|---:|:-------------------|-----------:|-----------:|                  
|  0 | 1                  | 0.974444   | 0.955827   |
|  1 | 2                  | 0.970588   | 0.959242   |                          
|  2 | 3                  | 0.975766   | 0.959022   |
|  3 | 4                  | 0.962873   | 0.944475   |                          
|  4 | 5                  | 0.968271   | 0.952297   |
|  5 | Max split          | 0.975766   | 0.959242   |                          
|  6 | Mean               | 0.970388   | 0.954173   |                                                                                                          
|  7 | Standart deviation | 0.00461214 | 0.00546833 |                          
                                                                               
#### Cross-val Balanced accuracy                                               
                                                                               
|    | Split              |        KNN |        SVM |                          
|---:|:-------------------|-----------:|-----------:|
|  0 | 1                  | 0.879402   | 0.841164   |                          
|  1 | 2                  | 0.86659    | 0.838937   |
|  2 | 3                  | 0.879935   | 0.843363   |
|  3 | 4                  | 0.865676   | 0.82344    |
|  4 | 5                  | 0.86764    | 0.834408   |                                                                                                          
|  5 | Max split          | 0.879935   | 0.843363   |
|  6 | Mean               | 0.871849   | 0.836263   |
|  7 | Standart deviation | 0.00641733 | 0.00706312 |                                     
                                                                               
#### Cross-val Top 1 accuracy                                                             
                                                                               
|    | Split              |        KNN |        SVM |                          
|---:|:-------------------|-----------:|-----------:| 
|  0 | 1                  | 0.974444   | 0.955827   |                          
|  1 | 2                  | 0.970588   | 0.959242   | 
|  2 | 3                  | 0.975766   | 0.959022   | 
|  3 | 4                  | 0.962873   | 0.944585   | 
|  4 | 5                  | 0.968271   | 0.952297   | 
|  5 | Max split          | 0.975766   | 0.959242   | 
|  6 | Mean               | 0.970388   | 0.954195   | 
|  7 | Standart deviation | 0.00461214 | 0.00542929 |                                     
                                                                               
#### Cross-val Top 2 accuracy                                                             
                                                                               
|    | Split              |        KNN |        SVM |                          
|---:|:-------------------|-----------:|-----------:|                                     
|  0 | 1                  | 0.994272   | 0.99284    |                                     
|  1 | 2                  | 0.992179   | 0.988544   |                                                     
|  2 | 3                  | 0.995373   | 0.990857   |                                     
|  3 | 4                  | 0.990526   | 0.992619   |                                                     
|  4 | 5                  | 0.989975   | 0.990966   |                                     
|  5 | Max split          | 0.995373   | 0.99284    |                                     
|  6 | Mean               | 0.992465   | 0.991165   |                                     
|  7 | Standart deviation | 0.00208658 | 0.00154426 |                                                     
                                                                                          
#### Cross-val Top 3 accuracy                                                                             
                                                                                          
|    | Split              |        KNN |         SVM |                                    
|---:|:-------------------|-----------:|------------:|                                    
|  0 | 1                  | 0.995924   | 0.998237    |                                    
|  1 | 2                  | 0.996475   | 0.997466    |                                    
|  2 | 3                  | 0.998127   | 0.998678    |                                                    
|  3 | 4                  | 0.992729   | 0.998678    |                                                                                                                               
|  4 | 5                  | 0.991958   | 0.998237    |                                                                         
|  5 | Max split          | 0.998127   | 0.998678    |                                                    
|  6 | Mean               | 0.995043   | 0.998259    |                                                                         
|  7 | Standart deviation | 0.00233301 | 0.000442798 |                                                    
                                                                                                          
#### Test set basic                                                                                       

|    |      KNN |     SVM |                                                                               
|---:|---------:|--------:|                                                                                                    
|  0 | 0.969416 | 0.95193 |                                                                               
                                                                                                          
#### Test set balanced                                                                                    
                                                                                                          
|    |     KNN |      SVM |                                                                               
|---:|--------:|---------:|                                                                                                    
|  0 | 0.87783 | 0.840501 |                                                                                                                                                                                         

#### Test set top k                                                                                                            

|    | Top   |      KNN |      SVM |                                                                                           
|---:|:------|---------:|---------:|                                                                                           
|  0 | Top_1 | 0.969416 | 0.95193  |                                                                                           
|  1 | Top_2 | 0.991086 | 0.987383 |                                                                                           
|  2 | Top_3 | 0.992663 | 0.994994 | 

## Version 1

`python3 -m sklearnex classification.py --n_jobs 18 cross-validation -db research_data/Bellevue_150th_SE38th/Bellevue_150th_SE38th_train_v2_10-18-20_11-08-14_clustered_4D_threshold-07.joblib --output research_data/Bellevue_150th_SE38th/tables/Bellevue_SE_v1_clustered_4D_threshold-07.xlsx --classification_features_version v1`  

Training dataset size: 9148  
Validation dataset size: 3060  

Number of clusters: 10  

*Time: 598 s*  

#### Classifier parameters

{'KNN': {'n_neighbors': 15}, 'SVM': {'kernel': 'rbf', 'probability': True, 'max_iter': 16000}}

#### Cross-val Basic accuracy

|    | Split              |        KNN |        SVM |
|---:|:-------------------|-----------:|-----------:|
|  0 | 1                  | 0.960656   | 0.914754   |
|  1 | 2                  | 0.968306   | 0.920765   |
|  2 | 3                  | 0.947541   | 0.911475   |
|  3 | 4                  | 0.960634   | 0.916348   |
|  4 | 5                  | 0.95626    | 0.90924    |
|  5 | Max split          | 0.968306   | 0.920765   |
|  6 | Mean               | 0.958679   | 0.914516   |
|  7 | Standart deviation | 0.00678698 | 0.00398857 |

#### Cross-val Balanced accuracy

|    | Split              |       KNN |        SVM |
|---:|:-------------------|----------:|-----------:|
|  0 | 1                  | 0.881877  | 0.760057   |
|  1 | 2                  | 0.913478  | 0.770662   |
|  2 | 3                  | 0.862273  | 0.763228   |
|  3 | 4                  | 0.906668  | 0.782721   |
|  4 | 5                  | 0.882582  | 0.761791   |
|  5 | Max split          | 0.913478  | 0.782721   |
|  6 | Mean               | 0.889376  | 0.767692   |
|  7 | Standart deviation | 0.0185306 | 0.00833951 |

#### Cross-val Top 1 accuracy

|    | Split              |        KNN |       SVM |
|---:|:-------------------|-----------:|----------:|
|  0 | 1                  | 0.960656   | 0.914754  |
|  1 | 2                  | 0.968306   | 0.919672  |
|  2 | 3                  | 0.947541   | 0.912568  |
|  3 | 4                  | 0.960634   | 0.916894  |
|  4 | 5                  | 0.95626    | 0.910334  |
|  5 | Max split          | 0.968306   | 0.919672  |
|  6 | Mean               | 0.958679   | 0.914845  |
|  7 | Standart deviation | 0.00678698 | 0.0032572 |

#### Cross-val Top 2 accuracy

|    | Split              |        KNN |        SVM |
|---:|:-------------------|-----------:|-----------:|
|  0 | 1                  | 0.996175   | 0.99071    |
|  1 | 2                  | 0.996175   | 0.987978   |
|  2 | 3                  | 0.991803   | 0.98306    |
|  3 | 4                  | 0.995626   | 0.990159   |
|  4 | 5                  | 0.993986   | 0.983598   |
|  5 | Max split          | 0.996175   | 0.99071    |
|  6 | Mean               | 0.994753   | 0.987101   |
|  7 | Standart deviation | 0.00167899 | 0.00321709 |

#### Cross-val Top 3 accuracy

|    | Split              |         KNN |        SVM |
|---:|:-------------------|------------:|-----------:|
|  0 | 1                  | 0.999454    | 0.998361   |
|  1 | 2                  | 0.998361    | 0.998361   |
|  2 | 3                  | 0.997268    | 0.995628   |
|  3 | 4                  | 0.997266    | 0.997266   |
|  4 | 5                  | 0.99672     | 0.995079   |
|  5 | Max split          | 0.999454    | 0.998361   |
|  6 | Mean               | 0.997814    | 0.996939   |
|  7 | Standart deviation | 0.000978084 | 0.00136569 |

#### Test set basic

|    |      KNN |      SVM |
|---:|---------:|---------:|
|  0 | 0.966667 | 0.916667 |

#### Test set balanced

|    |      KNN |      SVM |
|---:|---------:|---------:|
|  0 | 0.926677 | 0.770997 |

#### Test set top k

|    | Top   |      KNN |      SVM |
|---:|:------|---------:|---------:|
|  0 | Top_1 | 0.966667 | 0.916667 |
|  1 | Top_2 | 0.995752 | 0.986601 |
|  2 | Top_3 | 0.997386 | 0.997386 |

## Extended

### Version 1

python3 classification.py --n_jobs 16 cross-validation -db research_data/Bellevue_150th_SE38th/Bellevue_150th_SE38th_train_v2_10-18-20_11-08-14.joblib --output research_data/Bellevue_150th_SE38th/tables/Bellevue_150th_SE38th_v1_extended.xlsx --classification_features_version v1 --threshold 0.7 --min_samples 50 --m
ax_eps 0.2 --xi 0.15 -p 2                                                                                                                                                                                                                                                                                                     
Training dataset size: 9148                                                                                                                                                                                                                                   
Validation dataset size: 3060                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                              
Number of clusters: 10                                                                                                                                                                                                                                        
*Time: 2006 s*                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                              
#### Classifier parameters                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                              
{'KNN': {'n_neighbors': 15}, 'GP': {}, 'GNB': {}, 'MLP': {'max_iter': 5000, 'solver': 'sgd'}, 'SGD_modified_huber': {'loss': 'modified_huber'}, 'SGD_log_loss': {'loss': 'log_loss'}, 'SVM': {'kernel': 'rbf', 'probability': True, 'max_iter': 26000}, 'DT': {}}                                                                                                                                                                       
                                                                                                                                                                                                                                                              
#### Cross-val Basic accuracy                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                              
|    | Split              |        KNN |       GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |                                                                                                                           
|---:|:-------------------|-----------:|----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|                                                                                                                           
|  0 | 1                  | 0.959563   | 0.767213  | 0.8        |            0.780874  |      0.748087  | 0.906011   | 0.950273   |                                                                                                                           
|  1 | 2                  | 0.968306   | 0.789617  | 0.794536   |            0.789617  |      0.742077  | 0.91694    | 0.954098   |                                                                                                                                                                                                                                        
|  2 | 3                  | 0.947541   | 0.769945  | 0.798361   |            0.764481  |      0.746995  | 0.911475   | 0.940984   |                                                                                                                                                                                                                                        
|  3 | 4                  | 0.960634   | 0.805358  | 0.804265   |            0.755057  |      0.745216  | 0.920722   | 0.950793   |                                                                                                                                                                                           
|  4 | 5                  | 0.95626    | 0.758885  | 0.806452   |            0.723893  |      0.703116  | 0.911974   | 0.934937   |                                                                                                                           
|  5 | Max split          | 0.968306   | 0.805358  | 0.806452   |            0.789617  |      0.748087  | 0.920722   | 0.954098   |                                                                                                                           
|  6 | Mean               | 0.958461   | 0.778204  | 0.800722   |            0.762785  |      0.737098  | 0.913424   | 0.946217   |                                                                                                                           
|  7 | Standart deviation | 0.00673723 | 0.0169107 | 0.00423671 |            0.0229015 |      0.0171122 | 0.00502935 | 0.00712924 |                                                                                                                           
                                                                                                                                                                                                                                                              
#### Cross-val Balanced accuracy                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                              
|    | Split              |       KNN |       GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |       SVM |         DT |                                                                                                                             
|---:|:-------------------|----------:|----------:|-----------:|---------------------:|---------------:|----------:|-----------:|                                                                                                                             
|  0 | 1                  | 0.877529  | 0.689213  | 0.434383   |            0.463089  |       0.40345  | 0.75983   | 0.907572   |                                                                                                                             
|  1 | 2                  | 0.913478  | 0.735403  | 0.442636   |            0.448316  |       0.405516 | 0.773825  | 0.926554   |                                                                                                                                                                                                                                          
|  2 | 3                  | 0.862273  | 0.696758  | 0.447596   |            0.476351  |       0.362498 | 0.773237  | 0.90149    |                                                                                                                                                                                                                                          
|  3 | 4                  | 0.906668  | 0.737492  | 0.443172   |            0.550752  |       0.422196 | 0.801253  | 0.91288    |  
|  4 | 5                  | 0.882582  | 0.675842  | 0.442749   |            0.40423   |       0.342208 | 0.767831  | 0.899931   |  
|  5 | Max split          | 0.913478  | 0.737492  | 0.447596   |            0.550752  |       0.422196 | 0.801253  | 0.926554   |                                                                                                                             
|  6 | Mean               | 0.888506  | 0.706942  | 0.442107   |            0.468548  |       0.387174 | 0.775195  | 0.909685   |                                                                                                                             
|  7 | Standart deviation | 0.0189591 | 0.0250144 | 0.00428043 |            0.0477373 |       0.029862 | 0.0139647 | 0.00960745 |                                                                                                                             
                                                                                                                                                                                                                                                              
#### Cross-val Top 1 accuracy                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                              
|    | Split              |        KNN |       GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.959563   | 0.767213  | 0.801093   |            0.810929  |      0.70765   | 0.904918   | 0.95082    |                                                                                                                                                                                                                                        
|  1 | 2                  | 0.968306   | 0.789617  | 0.798907   |            0.738798  |      0.712568  | 0.919126   | 0.953552   |                                                                                                                                                                                                                                        
|  2 | 3                  | 0.947541   | 0.769945  | 0.804918   |            0.754645  |      0.731694  | 0.910929   | 0.943716   |                                                                                                                                                                                                                                        
|  3 | 4                  | 0.960634   | 0.805358  | 0.808092   |            0.749043  |      0.756151  | 0.920175   | 0.949153   |                                                                                                                           
|  4 | 5                  | 0.95626    | 0.758885  | 0.806998   |            0.806998  |      0.70749   | 0.910334   | 0.934937   |                                                                                                                           
|  5 | Max split          | 0.968306   | 0.805358  | 0.808092   |            0.810929  |      0.756151  | 0.920175   | 0.953552   |                                                                                                                           
|  6 | Mean               | 0.958461   | 0.778204  | 0.804002   |            0.772083  |      0.723111  | 0.913096   | 0.946435   |                                                                                                                           
|  7 | Standart deviation | 0.00673723 | 0.0169107 | 0.00349185 |            0.0305644 |      0.0187589 | 0.00575631 | 0.00658568 |                                                                                                                           
                                                                                                                                                                                                                                                              
#### Cross-val Top 2 accuracy                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                           
|    | Split              |        KNN |       GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |                                                                                                                                                                                                                                        
|---:|:-------------------|-----------:|----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|                                                                                                                                                                                                                                        
|  0 | 1                  | 0.996175   | 0.960109  | 0.881421   |            0.904918  |      0.88306   | 0.99235    | 0.960109   |                                                                                                                                                                                                                                        
|  1 | 2                  | 0.996175   | 0.955191  | 0.892896   |            0.898361  |      0.888525  | 0.992896   | 0.964481   |                                                                                                                                                                                                                                        
|  2 | 3                  | 0.991803   | 0.955191  | 0.887978   |            0.919672  |      0.866667  | 0.985792   | 0.957377   |                                                                                                                                                                                                                                        
|  3 | 4                  | 0.995626   | 0.961728  | 0.891197   |            0.920722  |      0.898305  | 0.990705   | 0.962274   |                                                                                                                                                                                                                                        
|  4 | 5                  | 0.993986   | 0.944779  | 0.893931   |            0.926736  |      0.897758  | 0.981411   | 0.950793   |                                                                                                                                                                                                                                        
|  5 | Max split          | 0.996175   | 0.961728  | 0.893931   |            0.926736  |      0.898305  | 0.992896   | 0.964481   |                                                                                                                                                                                                                                                                                                     
|  6 | Mean               | 0.994753   | 0.9554    | 0.889485   |            0.914082  |      0.886863  | 0.988631   | 0.959007   |                                                                                                                                                                                                                                                                                                     
|  7 | Standart deviation | 0.00167899 | 0.0059181 | 0.00450863 |            0.0106451 |      0.0116168 | 0.00439353 | 0.00473254 |                                                                                                                                                                                                                                                                                                     
                                                                                                                                                               
#### Cross-val Top 3 accuracy                                                                                                                                                        
                                                                                                                                                                                     
|    | Split              |         KNN |        GNB |       MLP |   SGD_modified_huber |   SGD_log_loss |       SVM |         DT |                                                                                                                                                                                                                                                                                                     
|---:|:-------------------|------------:|-----------:|----------:|---------------------:|---------------:|----------:|-----------:|                                                                                                                                                                                                                                                                                                     
|  0 | 1                  | 0.999454    | 0.989071   | 0.957377  |            0.936066  |      0.962842  | 0.998907  | 0.968306   |                                                                                                                                                                                                                                                                                                     
|  1 | 2                  | 0.998361    | 0.977596   | 0.959016  |            0.972678  |      0.956284  | 0.998361  | 0.96776    |                                                                                                                                                                                                                                                                                                     
|  2 | 3                  | 0.997268    | 0.981967   | 0.962842  |            0.954098  |      0.919672  | 0.996175  | 0.960656   |                                                                                                                                                                                                                                                                                                     
|  3 | 4                  | 0.997266    | 0.983051   | 0.952433  |            0.961728  |      0.934937  | 0.997813  | 0.965008   |                                                                                                                                                                                                                                                                                                     
|  4 | 5                  | 0.99672     | 0.974303   | 0.95298   |            0.95626   |      0.933844  | 0.995079  | 0.954073   |                                                                                                                                                                                                                                                                                                     
|  5 | Max split          | 0.999454    | 0.989071   | 0.962842  |            0.972678  |      0.962842  | 0.998907  | 0.968306   |                                                                                                                                                                                                                                                                                                     
|  6 | Mean               | 0.997814    | 0.981198   | 0.95693   |            0.956166  |      0.941516  | 0.997267  | 0.963161   |                                                                                                                                                                                                                                                                                                     
|  7 | Standart deviation | 0.000978084 | 0.00503049 | 0.0038814 |            0.0119321 |      0.0158252 | 0.0014257 | 0.00528949 |                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                     
#### Test set basic                                                                                                                                                                  
                                                                                                                                                                                     
|    |     KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |                                                                                 
|---:|--------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|                                                                                                                
|  0 | 0.96634 | 0.783987 | 0.812092 |             0.778105 |       0.740523 | 0.920588 | 0.947059 |                                                                                 

#### Test set balanced                                                                                    

|    |      KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |                                                                                                               
|---:|---------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|                                                                                                               
|  0 | 0.925997 | 0.726022 | 0.453623 |              0.46095 |       0.412353 | 0.783716 | 0.932742 |                                                                                                               

#### Test set top k                                                                                       

|    | Top   |      KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |                                                                                                       
|---:|:------|---------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|                                                                                                       
|  0 | Top_1 | 0.96634  | 0.783987 | 0.812092 |             0.778105 |       0.740523 | 0.920588 | 0.947059 |                                                                                                       
|  1 | Top_2 | 0.995752 | 0.953268 | 0.893464 |             0.916667 |       0.877778 | 0.989869 | 0.958824 |                                                                                                       
|  2 | Top_3 | 0.997386 | 0.983333 | 0.960131 |             0.949346 |       0.937255 | 0.997386 | 0.959804 |  

## Version 7

ython3 classification.py --n_jobs 16 cross-validation -db research_data/Bellevue_150th_SE38th/Bellevue_150th_SE38th_train_v2_10-18-20_11-08-14.joblib --output research_data/Bellevue_150th_SE38th/tables/Bellevue_150th_SE38th_v7_extended.xlsx --classification_features_version v7 --threshold 0.7 --min_samples 50 --max_eps 0.2 --xi 0.15 -p 2
Looking for min max values.: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16933/16933 [00:18<00:00, 940.44it/s]
Filter out edge detections.: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16933/16933 [00:00<00:00, 835466.24it/s]
False positive filtering.: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16933/16933 [00:00<00:00, 826117.52it/s]
Feature vectors.: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2679/2679 [00:00<00:00, 557783.09it/s]
2096
Features for classification.: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1572/1572 [00:03<00:00, 485.51it/s]
Features for classification.: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 524/524 [00:00<00:00, 1622.27it/s]

Training dataset size: 45388
Validation dataset size: 14583

Number of clusters: 10
Cross validate models: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [50:39<00:00, 434.23s/it]

*Time: 3039 s*

#### Classifier parameters

{'KNN': {'n_neighbors': 15}, 'GP': {}, 'GNB': {}, 'MLP': {'max_iter': 5000, 'solver': 'sgd'}, 'SGD_modified_huber': {'loss': 'modified_huber'}, 'SGD_log_loss': {'loss': 'log_loss'}, 'SVM': {'kernel': 'rbf', 'probability': True, 'max_iter': 26000}, 'DT': {}}

#### Cross-val Basic accuracy

|    | Split              |        KNN |       GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.974334   | 0.795329  | 0.956268   |            0.807777  |     0.749284   | 0.955717   | 0.958691   |
|  1 | 2                  | 0.970478   | 0.769112  | 0.958691   |            0.743556  |     0.756885   | 0.959903   | 0.95065    |
|  2 | 3                  | 0.975655   | 0.76746   | 0.960674   |            0.760189  |     0.756664   | 0.958581   | 0.959462   |
|  3 | 4                  | 0.962983   | 0.77151   | 0.933018   |            0.739451  |     0.749917   | 0.944475   | 0.939517   |
|  4 | 5                  | 0.968602   | 0.758951  | 0.953509   |            0.767655  |     0.757629   | 0.952297   | 0.940289   |
|  5 | Max split          | 0.975655   | 0.795329  | 0.960674   |            0.807777  |     0.757629   | 0.959903   | 0.959462   |
|  6 | Mean               | 0.97041    | 0.772473  | 0.952432   |            0.763726  |     0.754076   | 0.954195   | 0.949722   |
|  7 | Standart deviation | 0.00450194 | 0.0121869 | 0.00999908 |            0.0243497 |     0.00367347 | 0.00551756 | 0.00859427 |

#### Cross-val Balanced accuracy

|    | Split              |        KNN |       GNB |       MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |        DT |
|---:|:-------------------|-----------:|----------:|----------:|---------------------:|---------------:|-----------:|----------:|
|  0 | 1                  | 0.879371   | 0.661769  | 0.80963   |            0.500168  |     0.474055   | 0.841658   | 0.886391  |
|  1 | 2                  | 0.86665    | 0.629743  | 0.773687  |            0.453583  |     0.460614   | 0.839204   | 0.859966  |
|  2 | 3                  | 0.87983    | 0.619972  | 0.820852  |            0.564734  |     0.471585   | 0.84401    | 0.888998  |
|  3 | 4                  | 0.866232   | 0.609272  | 0.796427  |            0.530485  |     0.48096    | 0.823592   | 0.88381   |
|  4 | 5                  | 0.868036   | 0.611973  | 0.819723  |            0.505651  |     0.485136   | 0.834263   | 0.86813   |
|  5 | Max split          | 0.87983    | 0.661769  | 0.820852  |            0.564734  |     0.485136   | 0.84401    | 0.888998  |
|  6 | Mean               | 0.872024   | 0.626546  | 0.804064  |            0.510924  |     0.47447    | 0.836545   | 0.877459  |
|  7 | Standart deviation | 0.00621683 | 0.0189993 | 0.0175447 |            0.0366323 |     0.00844233 | 0.00723784 | 0.0113693 |

#### Cross-val Top 1 accuracy

|    | Split              |        KNN |       GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |       DT |
|---:|:-------------------|-----------:|----------:|-----------:|---------------------:|---------------:|-----------:|---------:|
|  0 | 1                  | 0.974334   | 0.795329  | 0.953073   |            0.745649  |      0.747411  | 0.955717   | 0.958581 |
|  1 | 2                  | 0.970478   | 0.769112  | 0.958801   |            0.806565  |      0.747852  | 0.959462   | 0.952633 |
|  2 | 3                  | 0.975655   | 0.76746   | 0.95781    |            0.773518  |      0.771095  | 0.958801   | 0.961555 |
|  3 | 4                  | 0.962983   | 0.77151   | 0.943594   |            0.750468  |      0.741875  | 0.944806   | 0.936323 |
|  4 | 5                  | 0.968602   | 0.758951  | 0.955712   |            0.762807  |      0.755977  | 0.952517   | 0.94117  |
|  5 | Max split          | 0.975655   | 0.795329  | 0.958801   |            0.806565  |      0.771095  | 0.959462   | 0.961555 |
|  6 | Mean               | 0.97041    | 0.772473  | 0.953798   |            0.767802  |      0.752842  | 0.954261   | 0.950052 |
|  7 | Standart deviation | 0.00450194 | 0.0121869 | 0.00546716 |            0.0216861 |      0.0101751 | 0.00533361 | 0.009789 |

#### Cross-val Top 2 accuracy

|    | Split              |        KNN |        GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|-----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.994272   | 0.942388   | 0.989205   |            0.927407  |     0.948337   | 0.99328    | 0.969487   |
|  1 | 2                  | 0.992179   | 0.939304   | 0.98623    |            0.947455  |     0.941066   | 0.988764   | 0.965521   |
|  2 | 3                  | 0.995373   | 0.947345   | 0.989755   |            0.961115  |     0.953404   | 0.991077   | 0.969817   |
|  3 | 4                  | 0.990746   | 0.944695   | 0.987881   |            0.94139   |     0.944365   | 0.992178   | 0.950424   |
|  4 | 5                  | 0.989864   | 0.929602   | 0.990195   |            0.929382  |     0.939738   | 0.991076   | 0.949983   |
|  5 | Max split          | 0.995373   | 0.947345   | 0.990195   |            0.961115  |     0.953404   | 0.99328    | 0.969817   |
|  6 | Mean               | 0.992487   | 0.940667   | 0.988653   |            0.94135   |     0.945382   | 0.991275   | 0.961046   |
|  7 | Standart deviation | 0.00207467 | 0.00613311 | 0.00143955 |            0.0123739 |     0.00499192 | 0.00149805 | 0.00898228 |

#### Cross-val Top 3 accuracy

|    | Split              |        KNN |        GNB |         MLP |   SGD_modified_huber |   SGD_log_loss |         SVM |         DT |
|---:|:-------------------|-----------:|-----------:|------------:|---------------------:|---------------:|------------:|-----------:|
|  0 | 1                  | 0.995924   | 0.973122   | 0.998127    |            0.976096  |     0.968385   | 0.998127    | 0.973342   |
|  1 | 2                  | 0.996585   | 0.971139   | 0.996365    |            0.975545  |     0.96453    | 0.998237    | 0.969927   |
|  2 | 3                  | 0.998017   | 0.976537   | 0.997907    |            0.976867  |     0.976757   | 0.998898    | 0.972902   |
|  3 | 4                  | 0.992839   | 0.970695   | 0.998237    |            0.961772  |     0.971687   | 0.998678    | 0.964856   |
|  4 | 5                  | 0.991958   | 0.96717    | 0.998678    |            0.948882  |     0.971687   | 0.998237    | 0.955051   |
|  5 | Max split          | 0.998017   | 0.976537   | 0.998678    |            0.976867  |     0.976757   | 0.998898    | 0.973342   |
|  6 | Mean               | 0.995065   | 0.971732   | 0.997863    |            0.967832  |     0.970609   | 0.998436    | 0.967216   |
|  7 | Standart deviation | 0.00229672 | 0.00307432 | 0.000790012 |            0.0110024 |     0.00405031 | 0.000298849 | 0.00679347 |

#### Test set basic

|    |      KNN |      GNB |     MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |
|---:|---------:|---------:|--------:|---------------------:|---------------:|---------:|---------:|
|  0 | 0.969279 | 0.786532 | 0.95289 |             0.781321 |       0.765549 | 0.952136 | 0.945347 |

#### Test set balanced

|    |      KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |
|---:|---------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|
|  0 | 0.877658 | 0.622599 | 0.820017 |             0.491029 |       0.468252 | 0.841832 | 0.870885 |

#### Test set top k

|    | Top   |      KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |
|---:|:------|---------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|
|  0 | Top_1 | 0.969279 | 0.786532 | 0.95289  |             0.781321 |       0.765549 | 0.952136 | 0.945347 |
|  1 | Top_2 | 0.990948 | 0.94041  | 0.99088  |             0.929301 |       0.934719 | 0.988205 | 0.954399 |
|  2 | Top_3 | 0.992526 | 0.971748 | 0.998697 |             0.975588 |       0.964342 | 0.995063 | 0.957005 |

## Version 7 stride 30

Training dataset size: 22279                                                                                                   
Validation dataset size: 7165                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

Number of clusters: 10


*Time: 2407 s*

#### Classifier parameters

{'KNN': {'n_neighbors': 15}, 'GP': {}, 'GNB': {}, 'MLP': {'max_iter': 5000, 'solver': 'sgd'}, 'SGD_modified_huber': {'loss': 'modified_huber'}, 'SGD_log_loss': {'loss': 'log_loss'}, 'SVM': {'kernel': 'rbf', 'probability': True, 'max_iter': 26000}, 'DT': {}}

#### Cross-val Basic accuracy

|    | Split              |        KNN |        GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|-----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.972172   | 0.82518    | 0.882181   |            0.763241  |     0.756957   | 0.948384   | 0.95579    |
|  1 | 2                  | 0.969255   | 0.803636   | 0.888689   |            0.812837  |     0.747756   | 0.956688   | 0.960054   |
|  2 | 3                  | 0.971948   | 0.803636   | 0.891158   |            0.782316  |     0.766158   | 0.954443   | 0.960054   |
|  3 | 4                  | 0.96342    | 0.803411   | 0.870063   |            0.776257  |     0.745961   | 0.943447   | 0.94614    |
|  4 | 5                  | 0.965881   | 0.813468   | 0.881481   |            0.792144  |     0.767452   | 0.949046   | 0.941414   |
|  5 | Max split          | 0.972172   | 0.82518    | 0.891158   |            0.812837  |     0.767452   | 0.956688   | 0.960054   |
|  6 | Mean               | 0.968535   | 0.809866   | 0.882715   |            0.785359  |     0.756857   | 0.950402   | 0.95269    |
|  7 | Standart deviation | 0.00342352 | 0.00856483 | 0.00733296 |            0.0166276 |     0.00894811 | 0.00469306 | 0.00759091 |

#### Cross-val Balanced accuracy

|    | Split              |        KNN |       GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|----------:|---------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.880602   | 0.685792  | 0.648991 |            0.545719  |     0.477503   | 0.843656   | 0.883143   |
|  1 | 2                  | 0.871807   | 0.662892  | 0.669981 |            0.574161  |     0.485878   | 0.846805   | 0.879266   |
|  2 | 3                  | 0.883937   | 0.65536   | 0.680142 |            0.500799  |     0.490237   | 0.847923   | 0.88979    |
|  3 | 4                  | 0.871431   | 0.648798  | 0.649944 |            0.495598  |     0.486019   | 0.833705   | 0.872285   |
|  4 | 5                  | 0.871567   | 0.674426  | 0.665171 |            0.525253  |     0.49562    | 0.841998   | 0.866912   |
|  5 | Max split          | 0.883937   | 0.685792  | 0.680142 |            0.574161  |     0.49562    | 0.847923   | 0.88979    |
|  6 | Mean               | 0.875869   | 0.665454  | 0.662846 |            0.528306  |     0.487051   | 0.842817   | 0.878279   |
|  7 | Standart deviation | 0.00533285 | 0.0132667 | 0.011949 |            0.0291262 |     0.00595277 | 0.00502733 | 0.00802829 |

#### Cross-val Top 1 accuracy

|    | Split              |        KNN |        GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|-----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.972172   | 0.82518    | 0.878591   |            0.753142  |     0.759425   | 0.948833   | 0.959156   |
|  1 | 2                  | 0.969255   | 0.803636   | 0.888465   |            0.813734  |     0.768402   | 0.956688   | 0.960278   |
|  2 | 3                  | 0.971948   | 0.803636   | 0.888914   |            0.760772  |     0.768402   | 0.954443   | 0.959829   |
|  3 | 4                  | 0.96342    | 0.803411   | 0.874551   |            0.772442  |     0.752469   | 0.943447   | 0.946813   |
|  4 | 5                  | 0.965881   | 0.813468   | 0.885073   |            0.80202   |     0.76633    | 0.948148   | 0.938721   |
|  5 | Max split          | 0.972172   | 0.82518    | 0.888914   |            0.813734  |     0.768402   | 0.956688   | 0.960278   |
|  6 | Mean               | 0.968535   | 0.809866   | 0.883119   |            0.780422  |     0.763006   | 0.950312   | 0.95296    |
|  7 | Standart deviation | 0.00342352 | 0.00856483 | 0.00565493 |            0.0235381 |     0.00621519 | 0.00472683 | 0.00871417 |

#### Cross-val Top 2 accuracy

|    | Split              |        KNN |        GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|-----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.994614   | 0.959156   | 0.969928   |            0.941876  |      0.949282  | 0.992594   | 0.965215   |
|  1 | 2                  | 0.993043   | 0.947711   | 0.970377   |            0.951526  |      0.951077  | 0.989004   | 0.969704   |
|  2 | 3                  | 0.996409   | 0.958483   | 0.976436   |            0.918537  |      0.965664  | 0.991697   | 0.969928   |
|  3 | 4                  | 0.992819   | 0.954443   | 0.969704   |            0.929084  |      0.958932  | 0.993716   | 0.959381   |
|  4 | 5                  | 0.992368   | 0.946577   | 0.980022   |            0.9578    |      0.943659  | 0.991919   | 0.953535   |
|  5 | Max split          | 0.996409   | 0.959156   | 0.980022   |            0.9578    |      0.965664  | 0.993716   | 0.969928   |
|  6 | Mean               | 0.993851   | 0.953274   | 0.973294   |            0.939765  |      0.953723  | 0.991786   | 0.963553   |
|  7 | Standart deviation | 0.00148624 | 0.00527067 | 0.00419221 |            0.0143719 |      0.0077167 | 0.00155865 | 0.00630874 |

#### Cross-val Top 3 accuracy

|    | Split              |        KNN |        GNB |        MLP |   SGD_modified_huber |   SGD_log_loss |        SVM |         DT |
|---:|:-------------------|-----------:|-----------:|-----------:|---------------------:|---------------:|-----------:|-----------:|
|  0 | 1                  | 0.996409   | 0.981822   | 0.993043   |            0.970601  |     0.969928   | 0.998429   | 0.968133   |
|  1 | 2                  | 0.997083   | 0.979354   | 0.992145   |            0.972846  |     0.966786   | 0.993043   | 0.97307    |
|  2 | 3                  | 0.998429   | 0.982944   | 0.993941   |            0.935592  |     0.98474    | 0.998878   | 0.973519   |
|  3 | 4                  | 0.994165   | 0.979129   | 0.996409   |            0.965215  |     0.980251   | 0.99798    | 0.964542   |
|  4 | 5                  | 0.993939   | 0.975533   | 0.994837   |            0.976655  |     0.978451   | 0.997306   | 0.958249   |
|  5 | Max split          | 0.998429   | 0.982944   | 0.996409   |            0.976655  |     0.98474    | 0.998878   | 0.973519   |
|  6 | Mean               | 0.996005   | 0.979757   | 0.994075   |            0.964182  |     0.976031   | 0.997127   | 0.967503   |
|  7 | Standart deviation | 0.00172352 | 0.00256213 | 0.00147216 |            0.0147667 |     0.00666659 | 0.00210712 | 0.00569173 |

#### Test set basic

|    |      KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |
|---:|---------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|
|  0 | 0.967062 | 0.826657 | 0.896162 |              0.77111 |       0.763294 | 0.947383 | 0.921982 |

#### Test set balanced

|    |      KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |
|---:|---------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|
|  0 | 0.882709 | 0.668758 | 0.677016 |             0.485581 |       0.459395 | 0.842639 | 0.857445 |

#### Test set top k

|    | Top   |      KNN |      GNB |      MLP |   SGD_modified_huber |   SGD_log_loss |      SVM |       DT |
|---:|:------|---------:|---------:|---------:|---------------------:|---------------:|---------:|---------:|
|  0 | Top_1 | 0.967062 | 0.826657 | 0.896162 |             0.77111  |       0.763294 | 0.947383 | 0.921982 |
|  1 | Top_2 | 0.992184 | 0.952826 | 0.972784 |             0.937195 |       0.94515  | 0.987718 | 0.935659 |
|  2 | Top_3 | 0.993022 | 0.979344 | 0.996092 |             0.955897 |       0.971668 | 0.994696 | 0.956315 |
