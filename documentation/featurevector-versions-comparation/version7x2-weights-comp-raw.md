Dataset loaded in 6 s
Number of tracks: 3836
Shape of feature vectors: (3836, 4)
Classes: [-1  0  1  2  3  4  5  6  7  8  9]
Number of labeled trajectories after clustering: 3170
Clustering done in 34 s
Clustered exit centroids: [0 1 3 0 2 2 3 1 2 2]
Exit points clusters: [0 1 2 3]
Exit point clustering done in 0 s
Train test split done in 0 s
Size of training set: 2536
Size of testing set: 634
Feature vectors generated in 1 s
Number of feature vectors in training set: 27679
Number of feature vectors in testing set: 6591
Classifier SVM trained in 14 s
Classifier SVM evaluation based on original clusters: balanced accuracy: 0.858225, top-1: 0.935215, top-2: 0.985435, top-3: 0.994841
Classifier SVM evaluation based on exit point centroids: balanced accuracy: 0.952362, top-1: 0.955697, top-2: 0.991352, top-3: 0.999241
Classifier KNN trained in 0 s
Classifier KNN evaluation based on original clusters: balanced accuracy: 0.895916, top-1: 0.951752, top-2: 0.996510, top-3: 0.997724
Classifier KNN evaluation based on exit point centroids: balanced accuracy: 0.963889, top-1: 0.966166, top-2: 0.998179, top-3: 0.998331
Classifier DT trained in 0 s
Classifier DT evaluation based on original clusters: balanced accuracy: 0.894180, top-1: 0.933394, top-2: 0.948111, top-3: 0.955090
Classifier DT evaluation based on exit point centroids: balanced accuracy: 0.949244, top-1: 0.939463, top-2: 0.945380, top-3: 0.945532

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.935215 | 0.985435 | 0.994841 |            0.858225 |
| KNN | 0.951752 | 0.99651  | 0.997724 |            0.895916 |
| DT  | 0.933394 | 0.948111 | 0.95509  |            0.89418  |

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.955697 | 0.991352 | 0.999241 |            0.952362 |
| KNN | 0.966166 | 0.998179 | 0.998331 |            0.963889 |
| DT  | 0.939463 | 0.94538  | 0.945532 |            0.949244 |

Dataset loaded in 230 s
Number of tracks: 32261
Shape of feature vectors: (32261, 4)
Classes: [-1  0  1  2  3  4  5  6  7  8]
Number of labeled trajectories after clustering: 32052
Clustering done in 421 s
Clustered exit centroids: [0 3 1 1 2 0 3 2 0]
Exit points clusters: [0 1 2 3]
Exit point clustering done in 0 s
Train test split done in 0 s
Size of training set: 16026
Size of testing set: 16026
Feature vectors generated in 62 s
Number of feature vectors in training set: 110048
Number of feature vectors in testing set: 110325
Classifier SVM trained in 105 s
Classifier SVM evaluation based on original clusters: balanced accuracy: 0.896031, top-1: 0.914988, top-2: 0.989250, top-3: 0.996828
Classifier SVM evaluation based on exit point centroids: balanced accuracy: 0.918564, top-1: 0.923336, top-2: 0.991697, top-3: 0.997725
Classifier KNN trained in 7 s
Classifier KNN evaluation based on original clusters: balanced accuracy: 0.920700, top-1: 0.926245, top-2: 0.985044, top-3: 0.986630
Classifier KNN evaluation based on exit point centroids: balanced accuracy: 0.927768, top-1: 0.932626, top-2: 0.984799, top-3: 0.985661
Classifier DT trained in 0 s
Classifier DT evaluation based on original clusters: balanced accuracy: 0.909188, top-1: 0.909785, top-2: 0.931584, top-3: 0.934412
Classifier DT evaluation based on exit point centroids: balanced accuracy: 0.919330, top-1: 0.912431, top-2: 0.919873, top-3: 0.919891

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.914988 | 0.98925  | 0.996828 |            0.896031 |
| KNN | 0.926245 | 0.985044 | 0.98663  |            0.9207   |
| DT  | 0.909785 | 0.931584 | 0.934412 |            0.909188 |

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.923336 | 0.991697 | 0.997725 |            0.918564 |
| KNN | 0.932626 | 0.984799 | 0.985661 |            0.927768 |
| DT  | 0.912431 | 0.919873 | 0.919891 |            0.91933  |

Dataset loaded in 50 s
Number of tracks: 42162
Shape of feature vectors: (42162, 4)
Classes: [-1  0  1  2  3  4  5  6  7  8  9 10]
Number of labeled trajectories after clustering: 39325
Clustering done in 518 s
Clustered exit centroids: [0 1 2 2 3 2 1 1 3 0 3]
Exit points clusters: [0 1 2 3]
Exit point clustering done in 0 s
Train test split done in 0 s
Size of training set: 19662
Size of testing set: 19663
Feature vectors generated in 48 s
Number of feature vectors in training set: 91978
Number of feature vectors in testing set: 94442
Classifier SVM trained in 112 s
Classifier SVM evaluation based on original clusters: balanced accuracy: 0.711571, top-1: 0.804166, top-2: 0.947301, top-3: 0.982190
Classifier SVM evaluation based on exit point centroids: balanced accuracy: 0.818314, top-1: 0.817115, top-2: 0.953675, top-3: 0.990936
Classifier KNN trained in 7 s
Classifier KNN evaluation based on original clusters: balanced accuracy: 0.777054, top-1: 0.817740, top-2: 0.972258, top-3: 0.981576
Classifier KNN evaluation based on exit point centroids: balanced accuracy: 0.830275, top-1: 0.824834, top-2: 0.975297, top-3: 0.983228
Classifier DT trained in 0 s
Classifier DT evaluation based on original clusters: balanced accuracy: 0.732131, top-1: 0.760615, top-2: 0.788992, top-3: 0.798014
Classifier DT evaluation based on exit point centroids: balanced accuracy: 0.773491, top-1: 0.762447, top-2: 0.791777, top-3: 0.792275

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.804166 | 0.947301 | 0.98219  |            0.711571 |
| KNN | 0.81774  | 0.972258 | 0.981576 |            0.777054 |
| DT  | 0.760615 | 0.788992 | 0.798014 |            0.732131 |

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.817115 | 0.953675 | 0.990936 |            0.818314 |
| KNN | 0.824834 | 0.975297 | 0.983228 |            0.830275 |
| DT  | 0.762447 | 0.791777 | 0.792275 |            0.773491 |

Dataset loaded in 207 s
Number of tracks: 21921
Shape of feature vectors: (21921, 4)
Classes: [-1  0  1  2  3  4  5  6  7  8  9 10 11 12]
Number of labeled trajectories after clustering: 21469
Clustering done in 280 s
Clustered exit centroids: [2 1 2 0 4 3 3 1 3 4 0 4 1]
Exit points clusters: [0 1 2 3 4]
Exit point clustering done in 0 s
Train test split done in 0 s
Size of training set: 10734
Size of testing set: 10735
Feature vectors generated in 64 s
Number of feature vectors in training set: 106417
Number of feature vectors in testing set: 107886
Classifier SVM trained in 192 s
Classifier SVM evaluation based on original clusters: balanced accuracy: 0.688299, top-1: 0.784940, top-2: 0.971331, top-3: 0.994179
Classifier SVM evaluation based on exit point centroids: balanced accuracy: 0.753088, top-1: 0.793940, top-2: 0.976169, top-3: 0.997701
Classifier KNN trained in 10 s
Classifier KNN evaluation based on original clusters: balanced accuracy: 0.855176, top-1: 0.879363, top-2: 0.978218, top-3: 0.981981
Classifier KNN evaluation based on exit point centroids: balanced accuracy: 0.896083, top-1: 0.886565, top-2: 0.980368, top-3: 0.983705
Classifier DT trained in 1 s
Classifier DT evaluation based on original clusters: balanced accuracy: 0.833859, top-1: 0.830126, top-2: 0.859027, top-3: 0.859361
Classifier DT evaluation based on exit point centroids: balanced accuracy: 0.846771, top-1: 0.835808, top-2: 0.863856, top-3: 0.863893

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.78494  | 0.971331 | 0.994179 |            0.688299 |
| KNN | 0.879363 | 0.978218 | 0.981981 |            0.855176 |
| DT  | 0.830126 | 0.859027 | 0.859361 |            0.833859 |

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.79394  | 0.976169 | 0.997701 |            0.753088 |
| KNN | 0.886565 | 0.980368 | 0.983705 |            0.896083 |
| DT  | 0.835808 | 0.863856 | 0.863893 |            0.846771 |

Dataset loaded in 84 s
Number of tracks: 33580
Shape of feature vectors: (33580, 4)
Classes: [-1  0  1  2  3  4  5  6  7  8  9 10]
Number of labeled trajectories after clustering: 32023
Clustering done in 420 s
Clustered exit centroids: [2 0 1 2 1 0 3 1 3 2 3]
Exit points clusters: [0 1 2 3]
Exit point clustering done in 0 s
Train test split done in 0 s
Size of training set: 11208
Size of testing set: 20815
Feature vectors generated in 281 s
Number of feature vectors in training set: 145912
Number of feature vectors in testing set: 266420
Classifier SVM trained in 190 s
Classifier SVM evaluation based on original clusters: balanced accuracy: 0.820619, top-1: 0.941296, top-2: 0.990436, top-3: 0.996547
Classifier SVM evaluation based on exit point centroids: balanced accuracy: 0.945426, top-1: 0.954816, top-2: 0.996858, top-3: 0.999422
Classifier KNN trained in 24 s
Classifier KNN evaluation based on original clusters: balanced accuracy: 0.881036, top-1: 0.955769, top-2: 0.989565, top-3: 0.994771
Classifier KNN evaluation based on exit point centroids: balanced accuracy: 0.965205, top-1: 0.968993, top-2: 0.993004, top-3: 0.993082
Classifier DT trained in 2 s
Classifier DT evaluation based on original clusters: balanced accuracy: 0.879294, top-1: 0.928264, top-2: 0.949028, top-3: 0.956996
Classifier DT evaluation based on exit point centroids: balanced accuracy: 0.944620, top-1: 0.940260, top-2: 0.949591, top-3: 0.949591

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.941296 | 0.990436 | 0.996547 |            0.820619 |
| KNN | 0.955769 | 0.989565 | 0.994771 |            0.881036 |
| DT  | 0.928264 | 0.949028 | 0.956996 |            0.879294 |

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.954816 | 0.996858 | 0.999422 |            0.945426 |
| KNN | 0.968993 | 0.993004 | 0.993082 |            0.965205 |
| DT  | 0.94026  | 0.949591 | 0.949591 |            0.94462  |

v705

(computer-vision) pecneb@pop-os:/media/pecneb/970evoplus/gitclones/computer_vision_research$ python3 -m sklearnex computer_vision_research/classification.py \
    --n-jobs 7 \
    train \
    --dataset \
    ../../cv_research_video_dataset/Bellevue_NE8th_24h_v2/Preprocessed_threshold_0.7_enter-exit-distance_1.0/ \
    --output \
    ../../cv_research_video_dataset/Bellevue_NE8th_24h_v2/Preprocessed_threshold_0.7_enter-exit-distance_1.0/ \
    --preprocessed \
    --test 0.65 \
    --min-samples 400 --max-eps 0.15 \
    --mse 0.2 --feature-version 7x0.5
Intel(R) Extension for Scikit-learn* enabled (https://github.com/intel/scikit-learn-intelex)
Dataset loaded in 82 s
Number of tracks: 33580
Feature vectors.: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33580/33580 [00:00<00:00, 524662.98it/s]
Shape of feature vectors: (33580, 4)
Classes: [-1  0  1  2  3  4  5  6  7  8  9 10]
Number of labeled trajectories after clustering: 32023
Clustering done in 405 s
Reduce labels: 32023it [00:00, 4360992.14it/s]
Clustered exit centroids: [2 3 1 2 1 3 0 1 0 2 0]
Exit points clusters: [0 1 2 3]
Exit point clustering done in 0 s
Train test split done in 0 s
Size of training set: 11208
Size of testing set: 20815
Features for classification.: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11208/11208 [00:54<00:00, 206.05it/s]
Features for classification.: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20815/20815 [03:10<00:00, 109.28it/s]
Feature vectors generated in 245 s
Number of feature vectors in training set: 145912
Number of feature vectors in testing set: 266420
Classifier SVM trained in 186 s
Classifier SVM evaluation based on original clusters: balanced accuracy: 0.820737, top-1: 0.941314, top-2: 0.990436, top-3: 0.996543
Classifier SVM evaluation based on exit point centroids: balanced accuracy: 0.945444, top-1: 0.954827, top-2: 0.996851, top-3: 0.999422
Classifier KNN trained in 23 s
Classifier KNN evaluation based on original clusters: balanced accuracy: 0.881036, top-1: 0.955769, top-2: 0.989565, top-3: 0.994771
Classifier KNN evaluation based on exit point centroids: balanced accuracy: 0.965205, top-1: 0.969023, top-2: 0.993000, top-3: 0.993086
Classifier DT trained in 1 s
Classifier DT evaluation based on original clusters: balanced accuracy: 0.878423, top-1: 0.927915, top-2: 0.949140, top-3: 0.956944
Classifier DT evaluation based on exit point centroids: balanced accuracy: 0.944176, top-1: 0.945383, top-2: 0.949827, top-3: 0.949831

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.941314 | 0.990436 | 0.996543 |            0.820737 |
| KNN | 0.955769 | 0.989565 | 0.994771 |            0.881036 |
| DT  | 0.927915 | 0.94914  | 0.956944 |            0.878423 |

|     |    Top-1 |    Top-2 |    Top-3 |   Balanced Accuracy |
|:----|---------:|---------:|---------:|--------------------:|
| SVM | 0.954827 | 0.996851 | 0.999422 |            0.945444 |
| KNN | 0.969023 | 0.993    | 0.993086 |            0.965205 |
| DT  | 0.945383 | 0.949827 | 0.949831 |            0.944176 |
